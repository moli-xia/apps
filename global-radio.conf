# --- 基础信息 ---
local app_id="global-radio"                         # 和文件名一致
local app_name="全球电台 (GlobalRadio)"             # 应用显示名称
local app_text="一个在线电台应用，支持全球电台收听、搜索、收藏、定时、多语言。"
local app_url="https://github.com/moli-xia/global-radio"
local docker_name="global-radio"                   # 容器名称
local docker_port="8080"                           # 默认访问端口，可被用户自定义
local app_size="1"                                 # 空间占用评分（1~10，当前镜像很小，设 1 即可）

# --- 核心逻辑 ---

# 1. 安装函数
docker_app_install() {
    # 必须在 /home/docker/ 下创建应用目录
    mkdir -p /home/docker/global-radio && cd /home/docker/global-radio

    # 下载并配置 compose 文件（通过 gh_proxy 加速）
    curl -L -o docker-compose.yml "${gh_proxy}raw.githubusercontent.com/moli-xia/global-radio/main/docker-compose.yml"

    # 端口处理（保持与 docker_compose 中默认 8080 一致）
    sed -i "s/\"8080:80\"/\"${docker_port}:80\"/g" docker-compose.yml

    # 启动容器
    docker compose up -d

    echo "安装完成"
}

# 2. 更新函数
docker_app_update() {
    cd /home/docker/global-radio
    docker compose pull
    docker compose up -d
    echo "更新完成"
}

# 3. 卸载函数
docker_app_uninstall() {
    cd /home/docker/global-radio
    docker compose down --rmi all
    rm -rf /home/docker/global-radio
    echo "卸载完成"
}

# --- 结尾必须包含此行以完成注册 ---
docker_app_plus
